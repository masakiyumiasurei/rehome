
@model ClientDetailModel
@using rehome.Models.DB;
@using rehome.Enums;
@using rehome.Models.Nissi;

 <div class="form-group">
                <div class="col-xs-offset-1 col-xs-11">
                    <div class="row">
                        @if (Model.Mode == ViewMode.Edit){

                            <div class="col-12 col-sm-4">
                                <a href="@Url.Action("New", "Nissi",new{顧客ID = Model.Client.顧客ID})" class="custom-btn btn-1"><i class="fa fa-plus-square" aria-hidden="true"></i>相談日誌</a>
                            </div>

                            <div class="col-12 col-sm-4">
                                <a href="@Url.Action("New_Kobetu", "Nissi",new{顧客ID = Model.Client.顧客ID})" class="custom-btn btn-1"><i class="fa fa-plus-square" aria-hidden="true"></i>個別支援日誌</a>
                            </div>

                            <div class="col-12 col-sm-4">
                                <a href="@Url.Action("New_Tokubetu", "Nissi",new{顧客ID = Model.Client.顧客ID})" class="custom-btn btn-1"><i class="fa fa-plus-square" aria-hidden="true"></i>特別支援日誌</a>
                            </div>

                        }
                    </div>    
                </div>
            </div>


            @if (Model.Nissi != null)
            {
                @*<h5>日誌一覧</h5>*@
                 <div class="table-responsive class col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <table id="Nissis" class="table table-striped table-hover table-sm "  style="width:100%">
                <thead>
                    <tr>
                        <td style="text-align:right">フィルター</td>
                        <td>@Html.DropDownListFor(m => m.支援区分フィルター, 日誌表示.支援区分items(), "",  new { @class ="form-control",@id="NissiFilter[1]", onchange="NissiFilter();"} )</td>
                        <td>@Html.DropDownListFor(m => m.担当名フィルター,new SelectList(Model.担当DropDownList, "Value", "Display"),  "",  new { @class ="form-control", @id="NissiFilter[2]", onchange="NissiFilter();"} )</td>
                        <td>@Html.DropDownListFor(m => m.相談者名フィルター,new SelectList(Model.相談者DropDownList, "Value", "Display"),  "",  new { @class ="form-control",@id="NissiFilter[3]", onchange="NissiFilter();"} )</td>
                        @*<td><input type="text" class="form-control" id="NissiFilter[1]" onchange="NissiFilter();" /></td>
                        <td><input type="text" class="form-control" id="NissiFilter[2]" onchange="NissiFilter();" /></td>
                        <td><input type="text" class="form-control" id="NissiFilter[3]" onchange="NissiFilter();" /></td>*@
                        <td><input type="text" class="form-control" id="NissiFilter[4]" onchange="NissiFilter();" /></td>
                        <td><input type="text" class="form-control" id="NissiFilter[5]" onchange="NissiFilter();" /></td>
                    </tr>
                    <tr>
                        <th>対応日</th>
                        <th>支援区分</th>
                        <th>担当名</th>
                        <th>相談者名</th>
                        <th>相談区分</th>
                        <th>相談内容</th>
                        <th>詳細</th>
                    </tr>
                </thead>

                @foreach (var item in Model.Nissi)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.対応日)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.支援区分)
                        </td>
                        
                        @*<td>
                            @if(item.相談者リスト != null){
                                for(var idx=0; idx < item.相談者リスト.Count(); idx++)
                                {
                                    <div>@Html.DisplayFor(modelItem => item.相談者リスト[idx].相談者名)</div>
                                }
                            }
                        </td>*@
                        <td>
                            <div>@Html.DisplayFor(modelItem => item.相談内容区分1)</div>
                            <div>@Html.DisplayFor(modelItem => item.相談内容区分2)</div>
                        </td>


                        <td>
                            <p class="omit_text" onclick="OmitTextSwitch()" style="width:100px;">@Html.DisplayFor(modelItem => item.内容)</p>
                        </td>

                        <td><div class="text-center">
                            @if(item.支援区分 == "相談")
                            {
                                <a class="custom-btn btn-1" href="@Url.Action("Details", "Nissi", new { 日誌ID = item.日誌ID })")"><i class="fa fa-info-circle" aria-hidden="true"></i></a>

                                @if (item.備考 != null)
                                {
                                    <div class="warning-text">備考あり要確認</div>
                                }
                            }else if(item.支援区分 == "個別支援")
                            {
                                <a class="custom-btn btn-1" href="@Url.Action("Details_Kobetu", "Nissi", new { 日誌ID = item.日誌ID })")"><i class="fa fa-info-circle" aria-hidden="true"></i></a>
                                @if (item.備考 != null)
                                {
                                   <div class="warning-text">備考あり要確認</div>
                                }
                            }else if(item.支援区分 == "特別支援")
                            {
                                
                                <a class="custom-btn btn-1" href="@Url.Action("Details_Tokubetu", "Nissi", new { 日誌ID = item.日誌ID })")"><i class="fa fa-info-circle" aria-hidden="true"></i></a>
                                @if (item.備考 != null)
                                {
                                    <div class="warning-text">備考あり要確認</div>
                                }
                            }

                        </div></td>
                    </tr>
                }
                </table>
                </div>
            }
